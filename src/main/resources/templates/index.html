<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Controle de Acesso E Ponto</title>
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <script type="text/javascript" lang="javascript" src="js/jquery-1.3.2.min.js"></script>
    
</head>
<body>
    <div class="conteiner">
        <div class="acessologin">
            <div class="acessotitulo">
                <h2 class="tituloacesso">Ponto e Acesso</h2>
            </div>
            <div class="acessoform">
                <form id="myform" name="myform" onsubmit="enviar(this)">
                    <div class="formdispo">
                        <input type="text" class="login" name="username" id="username" placeholder="NÂº Registro">
                        <input type="password" class="login" name="password" id="password" placeholder="Password">
                        <div class="forgetpass">
                            <a href="#" class="forgetlink">Forget Password</a>
                        </div>
                        <button type="button" class="buttonclass" onclick="enviar2()">Entrar</button>
                        
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script>
        function enviar2(){
            var user = document.getElementById("username");
            var pass = document.getElementById("password")
            const data =  {username:user.value, password:pass.value};
            fetch("/", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
            })
            .then((response) => response.json())
            .then((data1) => {
                console.log("Success:", data1);
                window.localStorage.setItem('token',data1.token);
                return redirecionar();
            })
            .catch((error) => {
                console.error("Error:", error);
            });

        }
        function redirecionar(){
            fetch("/tipodata/all", {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer " + window.localStorage.getItem('token'),
            },
            })
            .then((response) => response.json())
            .then((data) => {
                console.log("Success:", data);
            })
            .catch((error) => {
                console.error("Error:", error);
            });
        };
    </script>
</body>
</html>